# Music Library API

REST API сервис для управления онлайн библиотекой песен.

## Описание

Этот сервис предоставляет REST API для выполнения CRUD операций с песнями, включая получение информации о песнях, добавление новых песен, обновление существующих и удаление песен.  Сервис также позволяет получать текст песни с пагинацией по куплетам.

При добавлении новой песни, сервис обращается к внешнему API для получения дополнительной информации, такой как дата релиза и ссылка на ресурс. Полученная информация сохраняется в базе данных PostgreSQL.

## Функциональность

* **Получение списка песен:**  `/songs` (GET) с поддержкой пагинации и фильтрации по всем полям.
* **Создание новой песни:** `/songs` (POST)
* **Получение песни по ID:** `/songs/{id}` (GET)
* **Обновление песни:** `/songs/{id}` (PUT)
* **Удаление песни:** `/songs/{id}` (DELETE)
* **Получение куплетов песни с пагинацией:** `/songs/{id}/verses` (GET)
* **Добавление куплетов к песне:** `/songs/{id}/verses` (POST)

## API Документация

Swagger документация доступна по адресу:  `http://localhost:8080/swagger/index.html` после запуска сервиса.

## Технологии

* Go
* PostgreSQL
* Chi (роутер)
* Render (рендеринг JSON)
* sqlx (работа с базой данных)
* Goose (миграции базы данных)
* Swagger (документация API)

## Структура проекта

*   `internal/database`:  Реализация взаимодействия с базой данных.
*   `internal/handlers`:  HTTP обработчики запросов.
*   `internal/models`:  Модели данных.
*   `internal/service`:  Бизнес-логика сервиса.
*   `migrations`:  Файлы миграций базы данных.

## Запуск проекта

1.  **Клонировать репозиторий:**

    ```bash
    git clone <ссылка на репозиторий>
    ```

2.  **Создать файл .env:**

    Пример `.env`:

    ```
    POSTGRES_USER=user
    POSTGRES_PASSWORD=password
    POSTGRES_HOST=localhost
    POSTGRES_PORT=5432
    POSTGRES_DB=music_library
    API_URL=http://external-api:8081 // URL внешнего API
    PORT=8080
    ```

3.  **Запустить миграции базы данных:**
    ```bash
    goose postgres "postgres://<user>:<password>@<host>:<port>/<db>?sslmode=disable" up
    ```
    Замените `<user>`, `<password>`, `<host>`, `<port>` и `<db>`  на ваши данные.

4.  **Запустить сервис:**

    ```bash
    go run main.go
    ```
